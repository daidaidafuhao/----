{"version":3,"file":"index.js","sources":["pages/admin/index.vue","../../HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRtaW4vaW5kZXgudnVl"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"header\">\n\t\t\t<text class=\"title\">数据管理</text>\n\t\t</view>\n\t\t\n\t\t<view class=\"admin-container\">\n\t\t\t\n\t\t\t\n\t\t\t<view class=\"admin-panel\">\n\t\t\t\t<view class=\"panel-title\">导出数据</view>\n\t\t\t\t<view class=\"panel-content\">\n\t\t\t\t\t<view class=\"export-options\">\n\t\t\t\t\t\t<view class=\"export-option\">\n\t\t\t\t\t\t\t<text class=\"option-label\">数据范围：</text>\n\t\t\t\t\t\t\t<picker @change=\"handleDateRangeChange\" :value=\"dateRangeIndex\" :range=\"dateRanges\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{dateRanges[dateRangeIndex]}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view class=\"export-option\" v-if=\"dateRangeIndex === '3'\">\n\t\t\t\t\t\t\t<text class=\"option-label\">开始日期：</text>\n\t\t\t\t\t\t\t<picker mode=\"date\" :value=\"customStartDate\" @change=\"onStartDateChange\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{customStartDate}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view class=\"export-option\" v-if=\"dateRangeIndex === '3'\">\n\t\t\t\t\t\t\t<text class=\"option-label\">结束日期：</text>\n\t\t\t\t\t\t\t<picker mode=\"date\" :value=\"customEndDate\" @change=\"onEndDateChange\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{customEndDate}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view class=\"export-option\">\n\t\t\t\t\t\t\t<text class=\"option-label\">导出格式：</text>\n\t\t\t\t\t\t\t<picker @change=\"handleFormatChange\" :value=\"formatIndex\" :range=\"formats\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{formats[formatIndex]}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<button class=\"export-button\" type=\"primary\" @click=\"exportData\" :loading=\"exportLoading\">导出数据</button>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 添加导出未填数据按钮 -->\n\t\t\t\t\t<view class=\"export-missing-section\">\n\t\t\t\t\t\t<view class=\"export-option\">\n\t\t\t\t\t\t\t<text class=\"option-label\">开始日期：</text>\n\t\t\t\t\t\t\t<picker mode=\"date\" :value=\"missingStartDate\" @change=\"onMissingStartDateChange\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{missingStartDate}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view class=\"export-option\">\n\t\t\t\t\t\t\t<text class=\"option-label\">结束日期：</text>\n\t\t\t\t\t\t\t<picker mode=\"date\" :value=\"missingEndDate\" @change=\"onMissingEndDateChange\">\n\t\t\t\t\t\t\t\t<view class=\"picker-value\">\n\t\t\t\t\t\t\t\t\t<text>{{missingEndDate}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</picker>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<button class=\"export-button export-missing-button\" type=\"primary\" @click=\"exportMissingData\" :loading=\"missingExportLoading\">导出未填报名单</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"admin-panel\">\n\t\t\t\t<view class=\"panel-title\">系统统计</view>\n\t\t\t\t<view class=\"panel-content\">\n\t\t\t\t\t<view class=\"stats-grid\">\n\t\t\t\t\t\t<view class=\"stats-item\">\n\t\t\t\t\t\t\t<text class=\"stats-value\">{{userCount}}</text>\n\t\t\t\t\t\t\t<text class=\"stats-label\">用户总数</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"stats-item\">\n\t\t\t\t\t\t\t<text class=\"stats-value\">{{recordCount}}</text>\n\t\t\t\t\t\t\t<text class=\"stats-label\">记录总数</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"stats-item\">\n\t\t\t\t\t\t\t<text class=\"stats-value\">{{lastWeekCount}}</text>\n\t\t\t\t\t\t\t<text class=\"stats-label\">上周新增</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"stats-item\">\n\t\t\t\t\t\t\t<text class=\"stats-value\">{{activeUserCount}}</text>\n\t\t\t\t\t\t\t<text class=\"stats-label\">活跃用户</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- QR Code Modal -->\n\t\t<view class=\"qr-modal\" v-if=\"showQRModal\" @click=\"hideQRCode\">\n\t\t\t<view class=\"qr-content\" @click.stop>\n\t\t\t\t<view class=\"qr-title\">管理员注册二维码</view>\n\t\t\t\t<view class=\"qr-description\">扫描下方二维码成为管理员</view>\n\t\t\t\t<image class=\"qr-image\" src=\"/static/image/addadmin.jpg\" mode=\"aspectFit\"></image>\n\t\t\t\t<button class=\"qr-close\" @click=\"hideQRCode\">关闭</button>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport { getStatistics, exportAllData } from '../../common/api/admin.js';\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tdateRanges: ['最近一周', '最近一个月', '最近三个月', '自定义'],\n\t\t\t\tdateRangeIndex: 1,\n\t\t\t\tcustomStartDate: '',  // 先设为空，在created中初始化\n\t\t\t\tcustomEndDate: '',    // 先设为空，在created中初始化\n\t\t\t\tformats: ['Excel (.xlsx)', 'CSV (.csv)'],\n\t\t\t\tformatIndex: 0,\n\t\t\t\tuserCount: 0,\n\t\t\t\trecordCount: 0,\n\t\t\t\tlastWeekCount: 0,\n\t\t\t\tactiveUserCount: 0,\n\t\t\t\tloading: false,\n\t\t\t\texportLoading: false,        // 导出数据的loading状态\n\t\t\t\tmissingExportLoading: false, // 导出未填报名单的loading状态\n\t\t\t\tshowQRModal: false,  // 控制QR码弹窗显示\n\t\t\t\tmissingStartDate: '', // 未填报名单开始日期\n\t\t\t\tmissingEndDate: ''    // 未填报名单结束日期\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\t// 初始化日期\n\t\t\tthis.customEndDate = this.getCurrentDate();\n\t\t\tthis.customStartDate = this.getLastMonthDate();\n\t\t\tthis.missingEndDate = this.getCurrentDate();\n\t\t\tthis.missingStartDate = this.getLastWeekDate(); // 默认显示最近一周\n\t\t},\n\t\tonLoad() {\n\t\t\t// 获取实际统计数据\n\t\t\tthis.loadStatistics();\n\t\t},\n\t\tmethods: {\n\t\t\t\n\t\t\t\n\t\t\tloadStatistics() {\n\t\t\t\tconst openid = uni.getStorageSync('openid');\n\t\t\t\tif (!openid) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '登录状态已失效',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// 跳转到登录页\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\t\turl: '/pages/login/index'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1500);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.loading = true;\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '加载中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 调用云函数获取统计数据\n\t\t\t\tgetStatistics(openid)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.code === 0) {\n\t\t\t\t\t\t\tthis.userCount = res.data.userCount;\n\t\t\t\t\t\t\tthis.recordCount = res.data.recordCount;\n\t\t\t\t\t\t\tthis.lastWeekCount = res.data.lastWeekCount;\n\t\t\t\t\t\t\tthis.activeUserCount = res.data.activeUserCount;\n\t\t\t\t\t\t} else if (res.code === 403) {\n\t\t\t\t\t\t\t// 无权访问\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '无权访问管理页面',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 跳转回普通用户页面\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\t\t\turl: '/pages/data-entry/index'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '获取统计数据失败',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '获取统计数据失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconsole.error('获取统计数据出错', err);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tgetCurrentDate() {\n\t\t\t\tconst date = new Date();\n\t\t\t\tconst year = date.getFullYear();\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\t\t\t\tconst day = date.getDate().toString().padStart(2, '0');\n\t\t\t\treturn `${year}-${month}-${day}`;\n\t\t\t},\n\t\t\tgetLastMonthDate() {\n\t\t\t\tconst date = new Date();\n\t\t\t\tdate.setMonth(date.getMonth() - 1);\n\t\t\t\tconst year = date.getFullYear();\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\t\t\t\tconst day = date.getDate().toString().padStart(2, '0');\n\t\t\t\treturn `${year}-${month}-${day}`;\n\t\t\t},\n\t\t\thandleDateRangeChange(e) {\n\t\t\t\tthis.dateRangeIndex = e.detail.value;\n\t\t\t\tconsole.log(this.dateRangeIndex);\n\t\t\t\t\n\t\t\t\tconsole.log(this.dateRangeIndex===\"3\");\n\t\t\t},\n\t\t\thandleFormatChange(e) {\n\t\t\t\tthis.formatIndex = e.detail.value;\n\t\t\t\tconsole.log(this.formatIndex);\n\t\t\t},\n\t\t\tonStartDateChange(e) {\n\t\t\t\tthis.customStartDate = e.detail.value;\n\t\t\t},\n\t\t\tonEndDateChange(e) {\n\t\t\t\tthis.customEndDate = e.detail.value;\n\t\t\t},\n\t\t\tonMissingStartDateChange(e) {\n\t\t\t\tthis.missingStartDate = e.detail.value;\n\t\t\t},\n\t\t\tonMissingEndDateChange(e) {\n\t\t\t\tthis.missingEndDate = e.detail.value;\n\t\t\t},\n\t\t\tgetLastWeekDate() {\n\t\t\t\tconst date = new Date();\n\t\t\t\tdate.setDate(date.getDate() - 7);\n\t\t\t\tconst year = date.getFullYear();\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\t\t\t\tconst day = date.getDate().toString().padStart(2, '0');\n\t\t\t\treturn `${year}-${month}-${day}`;\n\t\t\t},\n\t\t\texportData() {\n\t\t\t\tconst openid = uni.getStorageSync('openid');\n\t\t\t\tif (!openid) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '登录状态已失效',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 构造日期范围\n\t\t\t\tlet dateRange = null;\n\t\t\t\tswitch (this.dateRangeIndex) {\n\t\t\t\t\tcase \"0\": // 最近一周\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst endDate = new Date();\n\t\t\t\t\t\t\tconst startDate = new Date();\n\t\t\t\t\t\t\tstartDate.setDate(endDate.getDate() - 7);\n\t\t\t\t\t\t\tdateRange = {\n\t\t\t\t\t\t\t\tstartDate: startDate.toISOString().split('T')[0],\n\t\t\t\t\t\t\t\tendDate: endDate.toISOString().split('T')[0]\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"1\": // 最近一个月\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst endDate = new Date();\n\t\t\t\t\t\t\tconst startDate = new Date();\n\t\t\t\t\t\t\tstartDate.setMonth(endDate.getMonth() - 1);\n\t\t\t\t\t\t\tdateRange = {\n\t\t\t\t\t\t\t\tstartDate: startDate.toISOString().split('T')[0],\n\t\t\t\t\t\t\t\tendDate: endDate.toISOString().split('T')[0]\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"2\": // 最近三个月\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst endDate = new Date();\n\t\t\t\t\t\t\tconst startDate = new Date();\n\t\t\t\t\t\t\tstartDate.setMonth(endDate.getMonth() - 3);\n\t\t\t\t\t\t\tdateRange = {\n\t\t\t\t\t\t\t\tstartDate: startDate.toISOString().split('T')[0],\n\t\t\t\t\t\t\t\tendDate: endDate.toISOString().split('T')[0]\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"3\": // 自定义\n\t\t\t\t\t\tdateRange = {\n\t\t\t\t\t\t\tstartDate: this.customStartDate,\n\t\t\t\t\t\t\tendDate: this.customEndDate\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconsole.log('自定义日期范围:', dateRange);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.exportLoading = true;\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '导出中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 获取文件格式\n\t\t\t\tconst format = this.formats[this.formatIndex].toLowerCase().split(' ')[0];\n\t\t\t\t// 去掉括号部分\n\t\t\t\tconst formatType = format === 'excel' ? 'xlsx' : 'csv';\n\t\t\t\t\n\t\t\t\t// 正常导出\n\t\t\t\tthis.doExport(openid, dateRange, formatType);\n\t\t\t},\n\t\t\t\n\t\t\t// 实际执行导出\n\t\t\tdoExport(openid, dateRange, formatType) {\n\t\t\t\t// 调用云函数导出数据\n\t\t\t\texportAllData(openid, dateRange, formatType)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tthis.exportLoading = false;\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.code === 0) {\n\t\t\t\t\t\t\t// 接收云函数返回的文件内容（Base64格式）\n\t\t\t\t\t\t\tconst fileData = res.data;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t// 检查文件数据是否存在\n\t\t\t\t\t\t\t\tif (!fileData.fileContent) {\n\t\t\t\t\t\t\t\t\tthrow new Error('文件内容为空');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 直接保存云函数生成好的文件\n\t\t\t\t\t\t\t\tthis.saveFileFromBase64(fileData.fileName, fileData.fileContent, fileData.fileType);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '数据导出成功',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tconsole.error('保存导出文件失败', error);\n\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '导出失败',\n\t\t\t\t\t\t\t\t\tcontent: `处理数据时出错: ${error.message || '未知错误'}`,\n\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (res.code === 403) {\n\t\t\t\t\t\t\t// 无权访问\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '无权执行导出操作',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\ttitle: '导出失败',\n\t\t\t\t\t\t\t\tcontent: res.message || '未知错误',\n\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tthis.exportLoading = false;\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '导出数据失败',\n\t\t\t\t\t\t\tcontent: err.message || '未知错误',\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconsole.error('导出数据出错', err);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 从Base64保存文件\n\t\t\tsaveFileFromBase64(fileName, base64Data, mimeType) {\n\t\t\t\t// 使用推荐的新API检查环境\n\t\t\t\tlet isMP = false;\n\t\t\t\ttry {\n\t\t\t\t\t// 检测微信小程序环境\n\t\t\t\t\tif (typeof wx !== 'undefined') {\n\t\t\t\t\t\tconst appBaseInfo = wx.getAppBaseInfo ? wx.getAppBaseInfo() : null;\n\t\t\t\t\t\tisMP = appBaseInfo ? appBaseInfo.platform === 'mp-weixin' : false;\n\t\t\t\t\t\t// 二次检查\n\t\t\t\t\t\tif (!isMP && typeof uni !== 'undefined' && uni.getSystemInfoSync) {\n\t\t\t\t\t\t\tconst sysInfo = uni.getSystemInfoSync();\n\t\t\t\t\t\t\tisMP = sysInfo.uniPlatform === 'mp-weixin';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn('环境检测失败，默认使用移动端处理', e);\n\t\t\t\t\t// 如果检测失败，默认为移动端处理\n\t\t\t\t\tisMP = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 检查环境，任何非浏览器环境都使用移动端处理方法\n\t\t\t\tconst isMobile = isMP || (typeof window === 'undefined');\n\t\t\t\t\n\t\t\t\tif (isMobile) {\n\t\t\t\t\t// 移动端和小程序处理\n\t\t\t\t\tthis.saveFileOnMobileFromBase64(fileName, base64Data, mimeType);\n\t\t\t\t} else {\n\t\t\t\t\t// 网页端处理 (H5环境)\n\t\t\t\t\tthis.saveFileOnWebFromBase64(fileName, base64Data, mimeType);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 移动端从Base64保存文件\n\t\t\tsaveFileOnMobileFromBase64(fileName, base64Data, mimeType) {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('开始处理文件保存:', fileName);\n\t\t\t\t\t\n\t\t\t\t\t// 先尝试直接预览，如果文件是PDF等可预览的类型\n\t\t\t\t\tconst isPdfOrExcel = /\\.(pdf|xlsx|xls|csv)$/i.test(fileName);\n\t\t\t\t\tif (isPdfOrExcel) {\n\t\t\t\t\t\tconsole.log('尝试直接预览文件内容');\n\t\t\t\t\t\tthis.previewFileFromBase64(fileName, base64Data, mimeType);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 接下来尝试保存文件\n\t\t\t\t\tthis.saveFileToLocalStorage(fileName, base64Data, mimeType);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('处理文件保存时出错', error);\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '保存文件出错',\n\t\t\t\t\t\tcontent: error.message || '未知错误',\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 尝试直接预览文件内容，跳过保存步骤\n\t\t\tpreviewFileFromBase64(fileName, base64Data, mimeType) {\n\t\t\t\ttry {\n\t\t\t\t\t// 获取文件系统管理器\n\t\t\t\t\tconst fs = uni.getFileSystemManager();\n\t\t\t\t\tconst tempFilePath = `${uni.env.USER_DATA_PATH}/temp_preview_${fileName}`;\n\t\t\t\t\t\n\t\t\t\t\t// 转换Base64为ArrayBuffer\n\t\t\t\t\tlet arrayBuffer = this.convertBase64ToArrayBuffer(base64Data);\n\t\t\t\t\t\n\t\t\t\t\t// 写入临时文件\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// 检查并创建目录\n\t\t\t\t\t\tconst dirPath = tempFilePath.substring(0, tempFilePath.lastIndexOf('/'));\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tfs.accessSync(dirPath);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tconsole.log('创建预览临时目录');\n\t\t\t\t\t\t\tfs.mkdirSync(dirPath, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 尝试删除已存在的临时文件\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tfs.accessSync(tempFilePath);\n\t\t\t\t\t\t\tfs.unlinkSync(tempFilePath);\n\t\t\t\t\t\t\tconsole.log('删除已存在的预览临时文件');\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t// 文件不存在，不需要操作\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 写入新临时文件\n\t\t\t\t\t\tfs.writeFileSync(tempFilePath, arrayBuffer, 'binary');\n\t\t\t\t\t\tconsole.log('预览临时文件写入成功:', tempFilePath);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 直接使用uni.openDocument预览\n\t\t\t\t\t\tuni.openDocument({\n\t\t\t\t\t\t\tfilePath: tempFilePath,\n\t\t\t\t\t\t\tshowMenu: true,\n\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\tconsole.log('成功打开预览文档');\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '文件已打开',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 提示用户可以保存\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\t\ttitle: '文件已打开',\n\t\t\t\t\t\t\t\t\t\tcontent: '您可以使用右上角的\"更多\"选项保存文件',\n\t\t\t\t\t\t\t\t\t\tconfirmText: '我知道了',\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\t\tconsole.error('预览文档失败', err);\n\t\t\t\t\t\t\t\t// 预览失败，回退到保存\n\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '预览失败',\n\t\t\t\t\t\t\t\t\tcontent: '无法直接预览，将尝试保存文件',\n\t\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\tthis.saveFileToLocalStorage(fileName, base64Data, mimeType);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (writeError) {\n\t\t\t\t\t\tconsole.error('写入预览临时文件失败', writeError);\n\t\t\t\t\t\tthrow new Error(`写入预览临时文件失败: ${writeError.message || '未知错误'}`);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('预览文件失败', error);\n\t\t\t\t\t// 回退到保存\n\t\t\t\t\tthis.saveFileToLocalStorage(fileName, base64Data, mimeType);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 将文件保存到本地存储\n\t\t\tsaveFileToLocalStorage(fileName, base64Data, mimeType) {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('尝试保存文件到本地存储');\n\t\t\t\t\t// 获取文件系统管理器\n\t\t\t\t\tconst fs = uni.getFileSystemManager();\n\t\t\t\t\tconst tempFilePath = `${uni.env.USER_DATA_PATH}/temp_${fileName}`;\n\t\t\t\t\t\n\t\t\t\t\t// 转换Base64为ArrayBuffer\n\t\t\t\t\tlet arrayBuffer = this.convertBase64ToArrayBuffer(base64Data);\n\t\t\t\t\t\n\t\t\t\t\t// 确保目录存在\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst dirPath = tempFilePath.substring(0, tempFilePath.lastIndexOf('/'));\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tfs.accessSync(dirPath);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tfs.mkdirSync(dirPath, true);\n\t\t\t\t\t\t\tconsole.log('创建保存目录');\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (dirError) {\n\t\t\t\t\t\tconsole.error('创建目录失败', dirError);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 尝试删除同名文件\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfs.accessSync(tempFilePath);\n\t\t\t\t\t\tfs.unlinkSync(tempFilePath);\n\t\t\t\t\t\tconsole.log('删除同名文件');\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t// 文件不存在，不需要操作\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 写入临时文件\n\t\t\t\t\tfs.writeFileSync(tempFilePath, arrayBuffer, 'binary');\n\t\t\t\t\tconsole.log('文件写入成功:', tempFilePath);\n\t\t\t\t\t\n\t\t\t\t\t// 使用uni.saveFile保存(这是跨平台的)\n\t\t\t\t\tuni.saveFile({\n\t\t\t\t\t\ttempFilePath: tempFilePath,\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tconsole.log('文件保存成功:', res.savedFilePath);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 打开保存的文件\n\t\t\t\t\t\t\tuni.openDocument({\n\t\t\t\t\t\t\t\tfilePath: res.savedFilePath,\n\t\t\t\t\t\t\t\tshowMenu: true,\n\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\tconsole.log('打开保存的文件成功');\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: '文件已保存并打开',\n\t\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfail: (openErr) => {\n\t\t\t\t\t\t\t\t\tconsole.error('打开文件失败', openErr);\n\t\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\t\ttitle: '保存成功',\n\t\t\t\t\t\t\t\t\t\tcontent: '文件已保存，但无法自动打开',\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (saveErr) => {\n\t\t\t\t\t\t\tconsole.error('保存文件失败', saveErr);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 如果是小程序环境，提示用户长按图片或使用右上角菜单保存\n\t\t\t\t\t\t\tif (typeof wx !== 'undefined') {\n\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '保存失败',\n\t\t\t\t\t\t\t\t\tcontent: '请使用右上角\"...\"菜单中的\"复制链接\"或\"分享给朋友\"功能来保存文件',\n\t\t\t\t\t\t\t\t\tconfirmText: '我知道了',\n\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '保存失败',\n\t\t\t\t\t\t\t\t\tcontent: `保存文件失败: ${saveErr.errMsg || '未知错误'}`,\n\t\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('保存到本地存储失败', error);\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '保存失败',\n\t\t\t\t\t\tcontent: error.message || '未知错误',\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 转换Base64为ArrayBuffer - 统一处理各种环境\n\t\t\tconvertBase64ToArrayBuffer(base64Data) {\n\t\t\t\ttry {\n\t\t\t\t\t// 处理Base64字符串，去掉可能的前缀\n\t\t\t\t\tlet base64Str = base64Data;\n\t\t\t\t\tif (base64Str.includes(',')) {\n\t\t\t\t\t\tbase64Str = base64Str.split(',')[1];\n\t\t\t\t\t}\n\t\t\t\t\t// 确保结尾没有换行符等特殊字符\n\t\t\t\t\tbase64Str = base64Str.replace(/[\\r\\n]/g, '');\n\t\t\t\t\t\n\t\t\t\t\tlet arrayBuffer;\n\t\t\t\t\t\n\t\t\t\t\t// 首先尝试使用wx的API(微信小程序环境)\n\t\t\t\t\tif (typeof wx !== 'undefined' && wx.base64ToArrayBuffer) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tarrayBuffer = wx.base64ToArrayBuffer(base64Str);\n\t\t\t\t\t\t\tconsole.log('使用wx.base64ToArrayBuffer成功');\n\t\t\t\t\t\t} catch (wxError) {\n\t\t\t\t\t\t\tconsole.warn('wx.base64ToArrayBuffer失败', wxError);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 如果wx的API失败，尝试使用uni的API\n\t\t\t\t\tif (!arrayBuffer && uni.base64ToArrayBuffer) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tarrayBuffer = uni.base64ToArrayBuffer(base64Str);\n\t\t\t\t\t\t\tconsole.log('使用uni.base64ToArrayBuffer成功');\n\t\t\t\t\t\t} catch (uniError) {\n\t\t\t\t\t\t\tconsole.warn('uni.base64ToArrayBuffer失败', uniError);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 如果上面的方法都失败，使用通用的JavaScript方法\n\t\t\t\t\tif (!arrayBuffer) {\n\t\t\t\t\t\tconsole.log('使用通用JavaScript方法转换Base64');\n\t\t\t\t\t\t// 通用的JavaScript方法\n\t\t\t\t\t\tconst binaryString = this.atob(base64Str);\n\t\t\t\t\t\tconst bytes = new Uint8Array(binaryString.length);\n\t\t\t\t\t\tfor (let i = 0; i < binaryString.length; i++) {\n\t\t\t\t\t\t\tbytes[i] = binaryString.charCodeAt(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tarrayBuffer = bytes.buffer;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!arrayBuffer) {\n\t\t\t\t\t\tthrow new Error('无法转换Base64到ArrayBuffer');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn arrayBuffer;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('Base64转换失败', error);\n\t\t\t\t\tthrow new Error(`Base64转换失败: ${error.message || '未知错误'}`);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 实现跨平台的atob函数\n\t\t\tatob(base64) {\n\t\t\t\t// 检查是否有原生atob\n\t\t\t\tif (typeof atob === 'function') {\n\t\t\t\t\treturn atob(base64);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 自己实现atob\n\t\t\t\tconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\t\t\t\tlet output = '';\n\t\t\t\tfor (\n\t\t\t\t\tlet bc = 0, bs, buffer, idx = 0;\n\t\t\t\t\t(buffer = base64.charAt(idx++));\n\t\t\t\t\t~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer, bc++ % 4)\n\t\t\t\t\t\t? (output += String.fromCharCode(255 & (bs >> ((-2 * bc) & 6))))\n\t\t\t\t\t\t: 0\n\t\t\t\t) {\n\t\t\t\t\tbuffer = chars.indexOf(buffer);\n\t\t\t\t}\n\t\t\t\treturn output;\n\t\t\t},\n\t\t\t\n\t\t\t// 网页端从Base64保存文件 (仅适用于H5环境)\n\t\t\tsaveFileOnWebFromBase64(fileName, base64Data, mimeType) {\n\t\t\t\ttry {\n\t\t\t\t\t// 检查是否在H5环境\n\t\t\t\t\tif (typeof window === 'undefined' || typeof document === 'undefined' ||\n\t\t\t\t\t\ttypeof Blob === 'undefined' || typeof URL === 'undefined') {\n\t\t\t\t\t\tthrow new Error('当前环境不支持网页下载方式');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// 创建Blob对象\n\t\t\t\t\tconst byteCharacters = atob(base64Data);\n\t\t\t\t\tconst byteNumbers = new Array(byteCharacters.length);\n\t\t\t\t\tfor (let i = 0; i < byteCharacters.length; i++) {\n\t\t\t\t\t\tbyteNumbers[i] = byteCharacters.charCodeAt(i);\n\t\t\t\t\t}\n\t\t\t\t\tconst byteArray = new Uint8Array(byteNumbers);\n\t\t\t\t\tconst blob = new Blob([byteArray], { type: mimeType });\n\t\t\t\t\t\n\t\t\t\t\t// 创建下载链接\n\t\t\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\t\t\tconst link = document.createElement('a');\n\t\t\t\t\tlink.href = url;\n\t\t\t\t\tlink.download = fileName;\n\t\t\t\t\t\n\t\t\t\t\t// 触发下载\n\t\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\t\tlink.click();\n\t\t\t\t\t\n\t\t\t\t\t// 清理\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tdocument.body.removeChild(link);\n\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t}, 0);\n\t\t\t\t\t\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '文件下载成功',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('网页下载方式失败', error);\n\t\t\t\t\t// 如果网页下载方式失败，尝试使用移动端方法\n\t\t\t\t\tthis.saveFileOnMobileFromBase64(fileName, base64Data, mimeType);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 导出未填报名单\n\t\t\texportMissingData() {\n\t\t\t\tconst openid = uni.getStorageSync('openid');\n\t\t\t\tif (!openid) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '登录状态已失效',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.missingExportLoading = true;\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '导出中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 获取文件格式\n\t\t\t\tconst format = this.formats[this.formatIndex].toLowerCase().split(' ')[0];\n\t\t\t\tconst formatType = format === 'excel' ? 'xlsx' : 'csv';\n\t\t\t\t\n\t\t\t\t// 调用云函数导出未填报名单\n\t\t\t\tuniCloud.callFunction({\n\t\t\t\t\tname: 'admin-service',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'exportMissingRecords',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tdateRange: {\n\t\t\t\t\t\t\t\tstartDate: this.missingStartDate,\n\t\t\t\t\t\t\t\tendDate: this.missingEndDate\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tformat: formatType\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tthis.missingExportLoading = false;\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\t// 接收云函数返回的文件内容（Base64格式）\n\t\t\t\t\t\tconst fileData = res.result.data;\n\t\t\t\t\t\t\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// 检查文件数据是否存在\n\t\t\t\t\t\t\tif (!fileData.fileContent) {\n\t\t\t\t\t\t\t\tthrow new Error('文件内容为空');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 直接保存云函数生成好的文件\n\t\t\t\t\t\t\tthis.saveFileFromBase64(fileData.fileName, fileData.fileContent, fileData.fileType);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '导出成功',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.error('保存导出文件失败', error);\n\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\ttitle: '导出失败',\n\t\t\t\t\t\t\t\tcontent: `处理数据时出错: ${error.message || '未知错误'}`,\n\t\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (res.result.code === 403) {\n\t\t\t\t\t\t// 无权访问\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '无权执行导出操作',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: '导出失败',\n\t\t\t\t\t\t\tcontent: res.result.message || '未知错误',\n\t\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tthis.missingExportLoading = false;\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '导出数据失败',\n\t\t\t\t\t\tcontent: err.message || '未知错误',\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t});\n\t\t\t\t\tconsole.error('导出数据出错', err);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.container {\n\t\tpadding: 20px;\n\t}\n\t\n\t.header {\n\t\tmargin-bottom: 20px;\n\t}\n\t\n\t.title {\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tcolor: #4095E5;\n\t}\n\t\n\t.admin-container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20px;\n\t}\n\t\n\t.admin-panel {\n\t\tbackground-color: #fff;\n\t\tborder-radius: 10px;\n\t\toverflow: hidden;\n\t\tbox-shadow: 0 2px 10px rgba(0,0,0,0.05);\n\t}\n\t\n\t.panel-title {\n\t\tfont-size: 18px;\n\t\tpadding: 15px;\n\t\tbackground-color: #f8f8f8;\n\t\tborder-bottom: 1px solid #eee;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.panel-content {\n\t\tpadding: 15px;\n\t}\n\t\n\t.export-options {\n\t\tmargin-bottom: 20px;\n\t}\n\t\n\t.export-option {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-bottom: 15px;\n\t}\n\t\n\t.option-label {\n\t\twidth: 100px;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.picker-value {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\theight: 40px;\n\t\tborder: 1px solid #ddd;\n\t\tborder-radius: 5px;\n\t\tpadding: 0 10px;\n\t}\n\t\n\t.picker-arrow {\n\t\tcolor: #999;\n\t\tfont-size: 12px;\n\t}\n\t\n\t.export-button {\n\t\twidth: 100%;\n\t}\n\t\n\t/* 添加管理员按钮样式 */\n\t.admin-button {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\tbackground-color: #4095E5;\n\t\tcolor: #fff;\n\t\tpadding: 12px 0;\n\t\ttext-align: center;\n\t\tborder-radius: 5px;\n\t\tfont-size: 16px;\n\t\tmargin-bottom: 10px;\n\t}\n\t\n\t.stats-grid {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t}\n\t\n\t.stats-item {\n\t\twidth: 50%;\n\t\tpadding: 15px;\n\t\ttext-align: center;\n\t}\n\t\n\t.stats-value {\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tcolor: #4095E5;\n\t\tdisplay: block;\n\t\tmargin-bottom: 5px;\n\t}\n\t\n\t.stats-label {\n\t\tcolor: #666;\n\t}\n\t\n\t/* QR码弹窗样式 */\n\t.qr-modal {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 999;\n\t}\n\t\n\t.qr-content {\n\t\tbackground-color: #fff;\n\t\tborder-radius: 10px;\n\t\tpadding: 20px;\n\t\twidth: 80%;\n\t\tmax-width: 320px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t}\n\t\n\t.qr-title {\n\t\tfont-size: 18px;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 10px;\n\t\tcolor: #4095E5;\n\t}\n\t\n\t.qr-description {\n\t\tfont-size: 14px;\n\t\tcolor: #666;\n\t\tmargin-bottom: 20px;\n\t\ttext-align: center;\n\t}\n\t\n\t.qr-image {\n\t\twidth: 200px;\n\t\theight: 200px;\n\t\tmargin-bottom: 20px;\n\t}\n\t\n\t.qr-close {\n\t\twidth: 80%;\n\t\tmargin-top: 10px;\n\t\tbackground-color: #4095E5;\n\t\tcolor: #fff;\n\t}\n\t\n\t.export-missing-section {\n\t\tmargin-top: 20px;\n\t\tpadding-top: 20px;\n\t\tborder-top: 1px solid #eee;\n\t}\n\t\n\t.export-missing-button {\n\t\tbackground-color: #67C23A;\n\t}\n</style> ","import MiniProgramPage from 'D:/pfh/git/----/pages/admin/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getStatistics","exportAllData","wx","uniCloud"],"mappings":"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"}