{"version":3,"file":"index.js","sources":["pages/data-entry/index.vue","../../HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGF0YS1lbnRyeS9pbmRleC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<text class=\"title\">血糖数据填报</text>\r\n\t\t\t<view class=\"title-underline\"></view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<uni-forms :modelValue=\"formData\" ref=\"form\" :rules=\"rules\" validateTrigger=\"bind\">\r\n\t\t\t\t<view class=\"grid-row\">\r\n\t\t\t\t\t<view class=\"grid-col\" :class=\"{ 'full-width': isNarrowScreen }\">\r\n\t\t\t\t\t\t<uni-forms-item label=\"日期\" class=\"label-right\">\r\n\t\t\t\t\t\t\t<view class=\"date-picker-container\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"left\" size=\"20\" color=\"#666\" @click=\"changeDate(-1)\" class=\"date-nav-icon\" />\r\n\t\t\t\t\t\t\t\t<uni-datetime-picker type=\"date\" v-model=\"formData.date\" class=\"date-picker\" @change=\"checkExistingRecord\" />\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"right\" size=\"20\" color=\"#666\" @click=\"changeDate(1)\" class=\"date-nav-icon\" />\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</uni-forms-item>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"grid-col\" :class=\"{ 'full-width': isNarrowScreen }\">\r\n\t\t\t\t\t\t<uni-forms-item label=\"空腹血糖值\" class=\"label-right\">\r\n\t\t\t\t\t\t\t<view class=\"input-container\">\r\n\t\t\t\t\t\t\t\t<uni-easyinput type=\"digit\" v-model=\"formData.fastingGlucose\" \r\n\t\t\t\t\t\t\t\t\tplaceholder=\"请输入\" \r\n\t\t\t\t\t\t\t\t\tclass=\"glucose-input\" \r\n\t\t\t\t\t\t\t\t\t:input-border=\"false\"\r\n\t\t\t\t\t\t\t\t\t@blur=\"validateGlucose('fastingGlucose')\" />\r\n\t\t\t\t\t\t\t\t<text class=\"unit-text\">mmol/L</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text v-if=\"glucoseErrors.fastingGlucose\" class=\"error-text\">{{glucoseErrors.fastingGlucose}}</text>\r\n\t\t\t\t\t\t</uni-forms-item>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"grid-col\" :class=\"{ 'full-width': isNarrowScreen }\">\r\n\t\t\t\t\t\t<uni-forms-item label=\"餐后两小时血糖值\" class=\"label-right\">\r\n\t\t\t\t\t\t\t<view class=\"input-container\">\r\n\t\t\t\t\t\t\t\t<uni-easyinput type=\"digit\" v-model=\"formData.postprandialGlucose\" \r\n\t\t\t\t\t\t\t\t\tplaceholder=\"请输入\" \r\n\t\t\t\t\t\t\t\t\tclass=\"glucose-input\" \r\n\t\t\t\t\t\t\t\t\t:input-border=\"false\"\r\n\t\t\t\t\t\t\t\t\t@blur=\"validateGlucose('postprandialGlucose')\" />\r\n\t\t\t\t\t\t\t\t<text class=\"unit-text\">mmol/L</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text v-if=\"glucoseErrors.postprandialGlucose\" class=\"error-text\">{{glucoseErrors.postprandialGlucose}}</text>\r\n\t\t\t\t\t\t\t<text v-if=\"!formData.postprandialGlucose && formData.fastingGlucose\" class=\"tip-text\">餐后血糖可稍后填写</text>\r\n\t\t\t\t\t\t</uni-forms-item>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!-- 新增血压输入框 -->\r\n\t\t\t\t\t<view class=\"grid-col\" :class=\"{ 'full-width': isNarrowScreen }\">\r\n\t\t\t\t\t\t<uni-forms-item label=\"血压\" class=\"label-right\">\r\n\t\t\t\t\t\t\t<view class=\"input-container\">\r\n\t\t\t\t\t\t\t\t<uni-easyinput type=\"text\" v-model=\"formData.bloodPressure\" \r\n\t\t\t\t\t\t\t\t\tplaceholder=\"请输入(例如:120/80)\" \r\n\t\t\t\t\t\t\t\t\tclass=\"glucose-input\" \r\n\t\t\t\t\t\t\t\t\t:input-border=\"false\" />\r\n\t\t\t\t\t\t\t\t<text class=\"unit-text\">mmHg</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"tip-text\">选填项，格式如:120/80</text>\r\n\t\t\t\t\t\t</uni-forms-item>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"form-button\">\r\n\t\t\t\t\t<button :type=\"canSubmit ? 'primary' : 'default'\" \r\n\t\t\t\t\t\t@click=\"submitForm\" \r\n\t\t\t\t\t\t:disabled=\"!canSubmit\" \r\n\t\t\t\t\t\t:class=\"{ 'btn-disabled': !canSubmit, 'btn-enabled': canSubmit }\">\r\n\t\t\t\t\t\t{{ submitButtonText }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view v-if=\"existingRecord\" class=\"record-info\">\r\n\t\t\t\t\t<text class=\"record-info-text\">{{ getRecordInfoText() }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { checkLoginAndRedirect } from '../../common/api/login.js';\r\n\timport { getWechatLoginState } from '../../common/api/wechat.js';\r\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tformData: {\r\n\t\t\t\t\tdate: this.getCurrentDate(),\r\n\t\t\t\t\tfastingGlucose: '',\r\n\t\t\t\t\tpostprandialGlucose: '',\r\n\t\t\t\t\tbloodPressure: '' // 新增血压字段\r\n\t\t\t\t},\r\n\t\t\t\tglucoseErrors: {\r\n\t\t\t\t\tfastingGlucose: '',\r\n\t\t\t\t\tpostprandialGlucose: ''\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tdate: {\r\n\t\t\t\t\t\trules: []\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfastingGlucose: {\r\n\t\t\t\t\t\trules: []\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpostprandialGlucose: {\r\n\t\t\t\t\t\trules: []\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 血压为选填项，不添加验证规则\r\n\t\t\t\t},\r\n\t\t\t\tisNarrowScreen: false,\r\n\t\t\t\texistingRecord: null, // 存储当前日期已有的记录\r\n\t\t\t\trecordId: null // 已有记录的ID\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tcanSubmit() {\r\n\t\t\t\t// 新逻辑：至少填写一项血糖值即可提交\r\n\t\t\t\treturn this.formData.date && \r\n\t\t\t\t\t(this.formData.fastingGlucose || this.formData.postprandialGlucose ||\r\n\t\t\t\t\t (this.existingRecord && (this.existingRecord.fastingGlucose || this.existingRecord.postprandialGlucose)));\r\n\t\t\t},\r\n\t\t\tsubmitButtonText() {\r\n\t\t\t\tif (this.existingRecord) {\r\n\t\t\t\t\treturn '更新记录';\r\n\t\t\t\t}\r\n\t\t\t\treturn '提交';\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// 检查登录状态，如果未登录则重定向到登录页面\r\n\t\t\tif (!checkLoginAndRedirect()) {\r\n\t\t\t\treturn; // 用户未登录，已重定向到登录页面\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 检测屏幕宽度，决定布局\r\n\t\t\tthis.checkScreenWidth();\r\n\t\t\t\r\n\t\t\t// 检查当天是否已有记录\r\n\t\t\tthis.checkExistingRecord();\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// 每次页面显示时检查登录状态\r\n\t\t\tif (!checkLoginAndRedirect()) {\r\n\t\t\t\treturn; // 用户未登录，已重定向到登录页面\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 检查当天是否已有记录\r\n\t\t\tthis.checkExistingRecord();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetRecordInfoText() {\r\n\t\t\t\tlet text = \"当前日期已有记录: \";\r\n\t\t\t\tif (this.existingRecord.fastingGlucose && this.existingRecord.postprandialGlucose) {\r\n\t\t\t\t\ttext += `空腹 ${this.existingRecord.fastingGlucose}mmol/L，餐后 ${this.existingRecord.postprandialGlucose}mmol/L`;\r\n\t\t\t\t} else if (this.existingRecord.fastingGlucose) {\r\n\t\t\t\t\ttext += `空腹 ${this.existingRecord.fastingGlucose}mmol/L`;\r\n\t\t\t\t} else if (this.existingRecord.postprandialGlucose) {\r\n\t\t\t\t\ttext += `餐后 ${this.existingRecord.postprandialGlucose}mmol/L`;\r\n\t\t\t\t}\r\n\t\t\t\treturn text;\r\n\t\t\t},\r\n\t\t\tcheckExistingRecord() {\r\n\t\t\t\tconst loginState = getWechatLoginState();\r\n\t\t\t\tif (!loginState.isLoggedIn) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 重置现有记录\r\n\t\t\t\tthis.existingRecord = null;\r\n\t\t\t\tthis.recordId = null;\r\n\t\t\t\t\r\n\t\t\t\t// 显示加载提示\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '查询记录...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 调用云函数查询当前日期是否已有记录\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'glucose-service',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getByDate',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tuserId: loginState.userInfo._id || loginState.openid,\r\n\t\t\t\t\t\t\tdate: this.formData.date\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tif (res.result && res.result.code === 0 && res.result.data) {\r\n\t\t\t\t\t\t// 找到了已有记录\r\n\t\t\t\t\t\tthis.existingRecord = res.result.data;\r\n\t\t\t\t\t\tthis.recordId = res.result.data._id;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 移除自动跳转到下一天的逻辑，始终显示当前日期的记录\r\n\t\t\t\t\t\t// 即使记录已经完整，也允许用户查看和修改\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 预填已有数据\r\n\t\t\t\t\t\tif (!this.formData.fastingGlucose && this.existingRecord.fastingGlucose) {\r\n\t\t\t\t\t\t\tthis.formData.fastingGlucose = this.existingRecord.fastingGlucose;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!this.formData.postprandialGlucose && this.existingRecord.postprandialGlucose) {\r\n\t\t\t\t\t\t\tthis.formData.postprandialGlucose = this.existingRecord.postprandialGlucose;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!this.formData.bloodPressure && this.existingRecord.bloodPressure) {\r\n\t\t\t\t\t\t\tthis.formData.bloodPressure = this.existingRecord.bloodPressure;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 没有找到记录\r\n\t\t\t\t\t\tthis.existingRecord = null;\r\n\t\t\t\t\t\tthis.recordId = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tconsole.error('查询记录失败', err);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcheckScreenWidth() {\r\n\t\t\t\tconst info = uni.getSystemInfoSync();\r\n\t\t\t\tthis.isNarrowScreen = info.windowWidth < 600; // 小于600px认为是窄屏\r\n\t\t\t},\r\n\t\t\tgetCurrentDate() {\r\n\t\t\t\tconst date = new Date();\r\n\t\t\t\tconst year = date.getFullYear();\r\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n\t\t\t\tconst day = date.getDate().toString().padStart(2, '0');\r\n\t\t\t\treturn `${year}-${month}-${day}`;\r\n\t\t\t},\r\n\t\t\tchangeDate(days) {\r\n\t\t\t\tconst currentDate = new Date(this.formData.date);\r\n\t\t\t\tcurrentDate.setDate(currentDate.getDate() + days);\r\n\t\t\t\tconst year = currentDate.getFullYear();\r\n\t\t\t\tconst month = (currentDate.getMonth() + 1).toString().padStart(2, '0');\r\n\t\t\t\tconst day = currentDate.getDate().toString().padStart(2, '0');\r\n\t\t\t\tthis.formData.date = `${year}-${month}-${day}`;\r\n\t\t\t\t\r\n\t\t\t\t// 日期变更时检查是否有记录\r\n\t\t\t\tthis.checkExistingRecord();\r\n\t\t\t},\r\n\t\t\tvalidateGlucose(field) {\r\n\t\t\t\tconst value = parseFloat(this.formData[field]);\r\n\t\t\t\t\r\n\t\t\t\t// 清除之前的错误\r\n\t\t\t\tthis.glucoseErrors[field] = '';\r\n\t\t\t\t\r\n\t\t\t\t// 检查是否为空\r\n\t\t\t\tif (!this.formData[field]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 检查范围\r\n\t\t\t\tif (isNaN(value)) {\r\n\t\t\t\t\tthis.glucoseErrors[field] = '请输入有效数值';\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 空腹血糖范围检查（一般3.9-6.1为正常）\r\n\t\t\t\tif (field === 'fastingGlucose') {\r\n\t\t\t\t\tif (value < 3.0) {\r\n\t\t\t\t\t\tthis.glucoseErrors[field] = '血糖值过低，请确认是否正确';\r\n\t\t\t\t\t} else if (value > 7.0) {\r\n\t\t\t\t\t\tthis.glucoseErrors[field] = '血糖值偏高，请注意控制';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 餐后血糖范围检查（一般<7.8为正常）\r\n\t\t\t\tif (field === 'postprandialGlucose') {\r\n\t\t\t\t\tif (value < 3.0) {\r\n\t\t\t\t\t\tthis.glucoseErrors[field] = '血糖值过低，请确认是否正确';\r\n\t\t\t\t\t} else if (value > 11.1) {\r\n\t\t\t\t\t\tthis.glucoseErrors[field] = '血糖值过高，请及时就医';\r\n\t\t\t\t\t} else if (value > 7.8) {\r\n\t\t\t\t\t\tthis.glucoseErrors[field] = '血糖值偏高，请注意控制';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsubmitForm() {\r\n\t\t\t\tif (!this.canSubmit) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 如果没有填写任何血糖值，提示用户\r\n\t\t\t\tif (!this.formData.fastingGlucose && !this.formData.postprandialGlucose &&\r\n\t\t\t\t\t!this.existingRecord) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请至少填写一项血糖值',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 直接执行提交，无需调用表单验证\r\n\t\t\t\t// 额外验证血糖值\r\n\t\t\t\tif (this.formData.fastingGlucose) {\r\n\t\t\t\t\tthis.validateGlucose('fastingGlucose');\r\n\t\t\t\t}\r\n\t\t\t\tif (this.formData.postprandialGlucose) {\r\n\t\t\t\t\tthis.validateGlucose('postprandialGlucose');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 如果有异常血糖值，只显示提示，但不阻止提交\r\n\t\t\t\tif (this.glucoseErrors.fastingGlucose || this.glucoseErrors.postprandialGlucose) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '血糖值异常，但仍可提交',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 显示加载提示\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: this.existingRecord ? '更新中...' : '提交中...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 获取用户ID\r\n\t\t\t\tconst loginState = getWechatLoginState();\r\n\t\t\t\tif (!loginState.isLoggedIn) {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '您尚未登录',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tcheckLoginAndRedirect();\r\n\t\t\t\t\t}, 1500);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 处理提交数据，保留已有数据不被空值覆盖\r\n\t\t\t\tconst submitData = {\r\n\t\t\t\t\tuserId: loginState.userInfo._id || loginState.openid,\r\n\t\t\t\t\tdate: this.formData.date,\r\n\t\t\t\t\tbloodPressure: this.formData.bloodPressure || (this.existingRecord ? this.existingRecord.bloodPressure || '' : '')\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// 只有当值不为空时才更新，否则保留已有的值\r\n\t\t\t\tif (this.formData.fastingGlucose) {\r\n\t\t\t\t\tsubmitData.fastingGlucose = this.formData.fastingGlucose;\r\n\t\t\t\t} else if (this.existingRecord && this.existingRecord.fastingGlucose) {\r\n\t\t\t\t\tsubmitData.fastingGlucose = this.existingRecord.fastingGlucose;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this.formData.postprandialGlucose) {\r\n\t\t\t\t\tsubmitData.postprandialGlucose = this.formData.postprandialGlucose;\r\n\t\t\t\t} else if (this.existingRecord && this.existingRecord.postprandialGlucose) {\r\n\t\t\t\t\tsubmitData.postprandialGlucose = this.existingRecord.postprandialGlucose;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 根据是否有现有记录决定是更新还是新增\r\n\t\t\t\tconst action = this.existingRecord ? 'update' : 'add';\r\n\t\t\t\tif (action === 'update') {\r\n\t\t\t\t\tsubmitData.recordId = this.recordId;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 调用云函数添加或更新血糖记录\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'glucose-service',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: action,\r\n\t\t\t\t\t\tparams: submitData\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\t// 请求成功\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tif (res.result && res.result.code === 0) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.result.message || (action === 'update' ? '更新成功' : '提交成功'),\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 更新本地记录状态\r\n\t\t\t\t\t\tif (action === 'add') {\r\n\t\t\t\t\t\t\tthis.recordId = res.result.data && res.result.data.id;\r\n\t\t\t\t\t\t\tthis.existingRecord = {...submitData, _id: this.recordId};\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.existingRecord = {...this.existingRecord, ...submitData};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 不管是否填写完两项，都不自动重置表单\r\n\t\t\t\t\t\t// 这样用户可以看到他们已经提交的数据\r\n\t\t\t\t\t\t// 让用户随时可以查看或修改已填写的记录\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: (res.result && res.result.message) || '提交失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t// 请求失败\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '网络错误，请稍后重试',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconsole.error('提交血糖数据失败', err);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tpadding: 20px;\r\n\t}\r\n\t\r\n\t.header {\r\n\t\tmargin-bottom: 30px;\r\n\t}\r\n\t\r\n\t.title {\r\n\t\tfont-size: 24px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #4095E5;\r\n\t}\r\n\t\r\n\t.title-underline {\r\n\t\theight: 4px;\r\n\t\twidth: 80px;\r\n\t\tbackground-color: #4095E5;\r\n\t\tmargin-top: 8px;\r\n\t\tborder-radius: 2px;\r\n\t}\r\n\t\r\n\t.form-card {\r\n\t\tbackground-color: #FAFAFA;\r\n\t\tborder-radius: 10px;\r\n\t\tpadding: 20px 15px;\r\n\t\tbox-shadow: 0 2px 10px rgba(0,0,0,0.05);\r\n\t}\r\n\t\r\n\t.grid-row {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tmargin: 0 -10px;\r\n\t}\r\n\t\r\n\t.grid-col {\r\n\t\tflex: 1;\r\n\t\tmin-width: 200px;\r\n\t\tpadding: 0 10px;\r\n\t\tmargin-bottom: 15px;\r\n\t}\r\n\t\r\n\t.full-width {\r\n\t\twidth: 100%;\r\n\t}\r\n\t\r\n\t.label-right :deep(.uni-forms-item__label) {\r\n\t\tjustify-content: flex-end;\r\n\t}\r\n\t\r\n\t.input-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 4px;\r\n\t\tborder: 1px solid #EAEAEA;\r\n\t\tpadding: 0 10px;\r\n\t\ttransition: all 0.3s;\r\n\t}\r\n\t\r\n\t.input-container:focus-within {\r\n\t\tborder-color: #4095E5;\r\n\t\tbox-shadow: 0 0 5px rgba(64, 149, 229, 0.3);\r\n\t}\r\n\t\r\n\t.glucose-input {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.unit-text {\r\n\t\tcolor: #999;\r\n\t\tmargin-left: 5px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\t\r\n\t.date-picker-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.date-picker {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.date-nav-icon {\r\n\t\tpadding: 5px;\r\n\t}\r\n\t\r\n\t.form-button {\r\n\t\tmargin-top: 30px;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t}\r\n\t\r\n\t.btn-disabled {\r\n\t\tbackground-color: #CCCCCC !important;\r\n\t\tcolor: #FFFFFF !important;\r\n\t}\r\n\t\r\n\t.btn-enabled {\r\n\t\tbackground-color: #07C160 !important;\r\n\t}\r\n\t\r\n\t.error-text {\r\n\t\tcolor: #FF5151;\r\n\t\tfont-size: 12px;\r\n\t\tmargin-top: 4px;\r\n\t}\r\n\t\r\n\t.tip-text {\r\n\t\tcolor: #999999;\r\n\t\tfont-size: 12px;\r\n\t\tmargin-top: 4px;\r\n\t}\r\n\t\r\n\t.record-info {\r\n\t\tmargin-top: 20px;\r\n\t\tpadding: 10px;\r\n\t\tbackground-color: #E6F7FF;\r\n\t\tborder-radius: 5px;\r\n\t\ttext-align: center;\r\n\t}\r\n\t\r\n\t.record-info-text {\r\n\t\tcolor: #4095E5;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\t\r\n\t/* 输入框聚焦态样式 */\r\n\t:deep(.uni-easyinput__content-input:focus) {\r\n\t\tbackground-color: rgba(64, 149, 229, 0.05);\r\n\t}\r\n</style> ","import MiniProgramPage from 'D:/pfh/git/----/pages/data-entry/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["checkLoginAndRedirect","getWechatLoginState","uni","uniCloud"],"mappings":"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"}