{"version":3,"file":"request.js","sources":["common/api/request.js"],"sourcesContent":["/**\r\n * 通用云函数请求模块\r\n */\r\n\r\n/**\r\n * 调用云函数\r\n * @param {String} name 云函数名称\r\n * @param {Object} data 参数 \r\n */\r\nfunction callCloudFunction(name, data = {}) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '加载中'\r\n\t\t});\r\n\t\t\r\n\t\tuniCloud.callFunction({\r\n\t\t\tname,\r\n\t\t\tdata\r\n\t\t}).then(res => {\r\n\t\t\tuni.hideLoading();\r\n\t\t\t\r\n\t\t\t// 请求成功，但业务状态异常\r\n\t\t\tif (res.result && res.result.code !== 0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: res.result.message || '请求失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treject(res.result);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 正常返回结果\r\n\t\t\tresolve(res.result);\r\n\t\t\t\r\n\t\t}).catch(err => {\r\n\t\t\tuni.hideLoading();\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '网络请求失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\tconsole.error(`调用云函数${name}出错:`, err);\r\n\t\t\treject(err);\r\n\t\t});\r\n\t});\r\n}\r\n\r\nexport default {\r\n\tcallCloudFunction\r\n}; "],"names":["uni","uniCloud"],"mappings":";;AASA,SAAS,kBAAkB,MAAM,OAAO,IAAI;AAC3C,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvCA,kBAAAA,MAAI,YAAY;AAAA,MACf,OAAO;AAAA,IACV,CAAG;AAEDC,kBAAAA,GAAS,aAAa;AAAA,MACrB;AAAA,MACA;AAAA,IACH,CAAG,EAAE,KAAK,SAAO;AACdD,oBAAG,MAAC,YAAW;AAGf,UAAI,IAAI,UAAU,IAAI,OAAO,SAAS,GAAG;AACxCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO,IAAI,OAAO,WAAW;AAAA,UAC7B,MAAM;AAAA,QACX,CAAK;AACD,eAAO,IAAI,MAAM;AACjB;AAAA,MACA;AAGD,cAAQ,IAAI,MAAM;AAAA,IAErB,CAAG,EAAE,MAAM,SAAO;AACfA,oBAAG,MAAC,YAAW;AACfA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACV,CAAI;AACDA,0BAAA,MAAA,SAAA,+BAAc,QAAQ,IAAI,OAAO,GAAG;AACpC,aAAO,GAAG;AAAA,IACb,CAAG;AAAA,EACH,CAAE;AACF;AAEA,MAAe,UAAA;AAAA,EACd;AACD;;"}