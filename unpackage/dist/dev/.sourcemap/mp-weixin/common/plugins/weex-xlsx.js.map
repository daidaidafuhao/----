{"version":3,"file":"weex-xlsx.js","sources":["common/plugins/weex-xlsx.js"],"sourcesContent":["/**\n * xlsx wrapper for uni-app\n * 用于在小程序中处理Excel文件的插件\n */\n\n// 声明XLSX变量\nlet XLSX;\n\n// 动态加载XLSX库\ntry {\n  // 尝试直接导入\n  XLSX = require('xlsx');\n} catch (e) {\n  // 如果直接导入失败，提供一个基本的实现\n  console.warn('xlsx库加载失败，部分功能可能不可用', e);\n  XLSX = {\n    utils: {\n      book_new: () => ({}),\n      aoa_to_sheet: () => ({}),\n      book_append_sheet: () => ({}),\n    },\n    write: () => new Uint8Array(),\n  };\n}\n\n// 导出XLSX对象，使其可以在其他地方被引用\nexport default XLSX;\n\n// 注册为全局插件\nconst install = (Vue) => {\n  if (typeof Vue.prototype !== 'undefined') {\n    Vue.prototype.$xlsx = XLSX;\n  } else if (Vue.config && Vue.config.globalProperties) {\n    // Vue 3\n    Vue.config.globalProperties.$xlsx = XLSX;\n  }\n  \n  // 扩展uni对象\n  if (typeof uni !== 'undefined') {\n    uni.xlsx = XLSX;\n  }\n};\n\n// 自动安装\nif (typeof window !== 'undefined' && window.Vue) {\n  install(window.Vue);\n}\n\nexport {\n  XLSX,\n  install\n}; "],"names":["uni"],"mappings":";;AAMA,IAAI;AAGJ,IAAI;AAEF,SAAO,QAAQ,MAAM;AACvB,SAAS,GAAG;AAEVA,gBAAa,MAAA,MAAA,QAAA,qCAAA,uBAAuB,CAAC;AACrC,SAAO;AAAA,IACL,OAAO;AAAA,MACL,UAAU,OAAO,CAAA;AAAA,MACjB,cAAc,OAAO,CAAA;AAAA,MACrB,mBAAmB,OAAO,CAAA;AAAA,IAC3B;AAAA,IACD,OAAO,MAAM,IAAI,WAAY;AAAA,EACjC;AACA;AAMK,MAAC,UAAU,CAAC,QAAQ;AACvB,MAAI,OAAO,IAAI,cAAc,aAAa;AACxC,QAAI,UAAU,QAAQ;AAAA,EACvB,WAAU,IAAI,UAAU,IAAI,OAAO,kBAAkB;AAEpD,QAAI,OAAO,iBAAiB,QAAQ;AAAA,EACrC;AAGD,MAAI,OAAOA,cAAG,UAAK,aAAa;AAC9BA,kBAAG,MAAC,OAAO;AAAA,EACZ;AACH;AAGA,IAAI,OAAO,WAAW,eAAe,OAAO,KAAK;AAC/C,UAAQ,OAAO,GAAG;AACpB;;"}